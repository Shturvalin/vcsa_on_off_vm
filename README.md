–°–∫—Ä–∏–ø—Ç –¥–ª—è –æ–¥–Ω–æ–≤—Ä–µ–º–µ–Ω–Ω–æ–≥–æ –≤–∫–ª—é—á–µ–Ω–∏—è\–≤—ã–∫–ª—é—á–µ–Ω–∏—è —É–∫–∞–∑–∞–Ω–Ω–æ–≥–æ —Å–ø–∏—Å–∫–∞ –í–ú –Ω–∞ vCSA. –°–Ω–∞—á–∞–ª–∞ –≤—ã–≤–æ–¥–∏—Ç—Å—è —Å–ø–∏—Å–æ–∫ –≤—Å–µ—Ö –∏–º–µ—é—â–∏—Ö—Å—è –í–ú, –ø–æ—Å–ª–µ —á–µ–≥–æ, –∏–¥–µ—Ç —Ü–∏–∫–ª–∏—á–Ω–æ–µ –≤–∫–ª—é—á–µ–Ω–∏–µ\–≤—ã–∫–ª—é—è—á—á–µ–Ω–∏–µ —É–∫–∞–∑–∞–Ω–Ω—ã—Ö id  –∑–∞–¥–∞–Ω–Ω–æ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —Ä–∞–∑.

üìú –ü–æ–ª–Ω–æ–µ –æ–ø–∏—Å–∞–Ω–∏–µ —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª–∞ —Å–∫—Ä–∏–ø—Ç–∞
üåê 1. –ê—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è –≤ vCenter
–§—É–Ω–∫—Ü–∏—è: get_auth_token()

–ß—Ç–æ –¥–µ–ª–∞–µ—Ç:
üîê –ü–æ–ª—É—á–∞–µ—Ç —Ç–æ–∫–µ–Ω –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏ —á–µ—Ä–µ–∑ REST API vCenter.
üîë –ò—Å–ø–æ–ª—å–∑—É–µ—Ç –ª–æ–≥–∏–Ω –∏ –ø–∞—Ä–æ–ª—å –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞.
‚ö†Ô∏è –ò–≥–Ω–æ—Ä–∏—Ä—É–µ—Ç SSL-–æ—à–∏–±–∫–∏ (verify=False).

üñ•Ô∏è 2. –ü–æ–ª—É—á–µ–Ω–∏–µ —Å–ø–∏—Å–∫–∞ –≤–∏—Ä—Ç—É–∞–ª—å–Ω—ã—Ö –º–∞—à–∏–Ω
–§—É–Ω–∫—Ü–∏—è: list_vms(token)

–ß—Ç–æ –¥–µ–ª–∞–µ—Ç:
üìã –ó–∞–ø—Ä–∞—à–∏–≤–∞–µ—Ç —Å–ø–∏—Å–æ–∫ –≤—Å–µ—Ö –í–ú –Ω–∞ vCenter.
üì° –û—Ç–ø—Ä–∞–≤–ª—è–µ—Ç GET-–∑–∞–ø—Ä–æ—Å —Å —Ç–æ–∫–µ–Ω–æ–º –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏.
üîç –í–æ–∑–≤—Ä–∞—â–∞–µ—Ç –¥–∞–Ω–Ω—ã–µ –≤ —Ñ–æ—Ä–º–∞—Ç–µ JSON (ID –∏ –∏–º–µ–Ω–∞ –í–ú).

‚ö° 3. –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å–æ—Å—Ç–æ—è–Ω–∏—è –ø–∏—Ç–∞–Ω–∏—è –í–ú
–§—É–Ω–∫—Ü–∏—è: get_vm_power_state(token, vm_id)

–ß—Ç–æ –¥–µ–ª–∞–µ—Ç:
üîå –û–ø—Ä–µ–¥–µ–ª—è–µ—Ç —Ç–µ–∫—É—â–∏–π —Å—Ç–∞—Ç—É—Å –í–ú (–≤–∫–ª—é—á–µ–Ω–∞/–≤—ã–∫–ª—é—á–µ–Ω–∞).
üìä –ò–∑–≤–ª–µ–∫–∞–µ—Ç –¥–∞–Ω–Ω—ã–µ —á–µ—Ä–µ–∑ GET-–∑–∞–ø—Ä–æ—Å –∫ API.
üö® –û–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç –æ—à–∏–±–∫–∏ –æ—Ç—Å—É—Ç—Å—Ç–≤–∏—è –ø–æ–ª—è power_state.

üü¢ 4. –í–∫–ª—é—á–µ–Ω–∏–µ –≤–∏—Ä—Ç—É–∞–ª—å–Ω–æ–π –º–∞—à–∏–Ω—ã
–§—É–Ω–∫—Ü–∏—è: power_on_vm(token, vm_id)

–ß—Ç–æ –¥–µ–ª–∞–µ—Ç:
üèÉ‚ôÇÔ∏è –û—Ç–ø—Ä–∞–≤–ª—è–µ—Ç POST-–∑–∞–ø—Ä–æ—Å –¥–ª—è –∑–∞–ø—É—Å–∫–∞ –í–ú.
‚úÖ –û–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç —É—Å–ø–µ—à–Ω—ã–µ –∫–æ–¥—ã –æ—Ç–≤–µ—Ç–æ–≤ (200 –∏ 204).
‚ùå –í—ã–≤–æ–¥–∏—Ç –æ—à–∏–±–∫–∏ –ø—Ä–∏ –Ω–µ—É–¥–∞—á–µ.

üî¥ 5. –í—ã–∫–ª—é—á–µ–Ω–∏–µ –≤–∏—Ä—Ç—É–∞–ª—å–Ω–æ–π –º–∞—à–∏–Ω—ã
–§—É–Ω–∫—Ü–∏—è: power_off_vm(token, vm_id)

–ß—Ç–æ –¥–µ–ª–∞–µ—Ç:
üõë –û—Ç–ø—Ä–∞–≤–ª—è–µ—Ç POST-–∑–∞–ø—Ä–æ—Å –¥–ª—è –æ—Å—Ç–∞–Ω–æ–≤–∫–∏ –í–ú.
‚úÖ –ê–Ω–∞–ª–æ–≥–∏—á–Ω–æ –ø—Ä–æ–≤–µ—Ä—è–µ—Ç –∫–æ–¥—ã –æ—Ç–≤–µ—Ç–æ–≤.
‚ùå –õ–æ–≥–∏—Ä—É–µ—Ç –æ—à–∏–±–∫–∏ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è.

üîÑ 6. –¶–∏–∫–ª–∏—á–µ—Å–∫–æ–µ —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –í–ú
–§—É–Ω–∫—Ü–∏—è: manage_vms(token)

–ß—Ç–æ –¥–µ–ª–∞–µ—Ç:
‚ôæÔ∏è –ó–∞–ø—É—Å–∫–∞–µ—Ç —Ü–∏–∫–ª –Ω–∞ iterations –∏—Ç–µ—Ä–∞—Ü–∏–π.
‚è±Ô∏è –ü–∞—Ä–∞–ª–ª–µ–ª—å–Ω–æ –≤–∫–ª—é—á–∞–µ—Ç –í–ú —á–µ—Ä–µ–∑ ThreadPoolExecutor.
‚è≥ –ñ–¥–µ—Ç action_duration (60 —Å–µ–∫.), –∑–∞—Ç–µ–º –≤—ã–∫–ª—é—á–∞–µ—Ç –í–ú.
üïí –ü–∞—É–∑–∞ action_interval (10 —Å–µ–∫.) –º–µ–∂–¥—É —Ü–∏–∫–ª–∞–º–∏.
üö¶ –û–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç –∏—Å–∫–ª—é—á–µ–Ω–∏—è –¥–ª—è –∫–∞–∂–¥–æ–π –í–ú.

üöÄ 7. –û—Å–Ω–æ–≤–Ω–∞—è –ª–æ–≥–∏–∫–∞
–§—É–Ω–∫—Ü–∏—è: main()

–ß—Ç–æ –¥–µ–ª–∞–µ—Ç:
üîÑ –í—ã–∑—ã–≤–∞–µ—Ç –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—é –∏ –≤—ã–≤–æ–¥ —Å–ø–∏—Å–∫–∞ –í–ú.
üñ®Ô∏è –ü–µ—á–∞—Ç–∞–µ—Ç ID –∏ –∏–º–µ–Ω–∞ –¥–æ—Å—Ç—É–ø–Ω—ã—Ö –í–ú.
üõ†Ô∏è –ó–∞–ø—É—Å–∫–∞–µ—Ç —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ (manage_vms).
üõ°Ô∏è –õ–æ–≤–∏—Ç –≥–ª–æ–±–∞–ª—å–Ω—ã–µ –∏—Å–∫–ª—é—á–µ–Ω–∏—è.

‚öôÔ∏è 8. –ù–∞—Å—Ç—Ä–æ–π–∫–∏ —Å–∫—Ä–∏–ø—Ç–∞
–ü–∞—Ä–∞–º–µ—Ç—Ä—ã:
üñ•Ô∏è vcenter_server ‚Äî IP-–∞–¥—Ä–µ—Å vCenter.
üë§ username, password ‚Äî —É—á–µ—Ç–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ.
üìã vm_ids ‚Äî —Å–ø–∏—Å–æ–∫ ID –í–ú –¥–ª—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è.
‚è≤Ô∏è action_interval ‚Äî –ø–∞—É–∑–∞ –º–µ–∂–¥—É —Ü–∏–∫–ª–∞–º–∏.
‚è≥ action_duration ‚Äî –≤—Ä–µ–º—è —Ä–∞–±–æ—Ç—ã –í–ú –ø–µ—Ä–µ–¥ –≤—ã–∫–ª—é—á–µ–Ω–∏–µ–º.
üîÅ iterations ‚Äî –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –ø–æ–≤—Ç–æ—Ä–æ–≤ —Ü–∏–∫–ª–∞.

üö® –û—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏ –∏ –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è
‚ö†Ô∏è –ü–∞—Ä–æ–ª—å —Ö—Ä–∞–Ω–∏—Ç—Å—è –≤ –æ—Ç–∫—Ä—ã—Ç–æ–º –≤–∏–¥–µ (–Ω–µ–±–µ–∑–æ–ø–∞—Å–Ω–æ!).

üîÑ –ò—Å–ø–æ–ª—å–∑—É–µ—Ç –º–Ω–æ–≥–æ–ø–æ—Ç–æ—á–Ω–æ—Å—Ç—å –¥–ª—è —É—Å–∫–æ—Ä–µ–Ω–∏—è –æ–ø–µ—Ä–∞—Ü–∏–π.

üîí –ò–≥–Ω–æ—Ä–∏—Ä—É–µ—Ç SSL-–æ—à–∏–±–∫–∏ (—Ç–æ–ª—å–∫–æ –¥–ª—è —Ç–µ—Å—Ç–æ–≤—ã—Ö —Å—Ä–µ–¥!).

üìà –ü—Ä–µ–¥–Ω–∞–∑–Ω–∞—á–µ–Ω –¥–ª—è –Ω–∞–≥—Ä—É–∑–æ—á–Ω–æ–≥–æ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è –∏–ª–∏ –∞–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏–∏ –∑–∞–¥–∞—á.

üõ†Ô∏è –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ –ø–æ —É–ª—É—á—à–µ–Ω–∏—é
–ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è –¥–ª—è –ø–∞—Ä–æ–ª—è.

–î–æ–±–∞–≤–∏—Ç—å –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –≤ —Ñ–∞–π–ª.

–†–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å –æ–±—Ä–∞–±–æ—Ç–∫—É —Å–∏–≥–Ω–∞–ª–æ–≤ (Ctrl+C).

–í–∞–ª–∏–¥–∏—Ä–æ–≤–∞—Ç—å –≤—Ö–æ–¥–Ω—ã–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã (IP, ID –í–ú).

–î–æ–±–∞–≤–∏—Ç—å –ø—Ä–æ–≤–µ—Ä–∫—É —Å—Ç–∞—Ç—É—Å–∞ –í–ú –ø–µ—Ä–µ–¥ –¥–µ–π—Å—Ç–≤–∏—è–º–∏.
